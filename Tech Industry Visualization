
# Load required libraries
library(shiny)
library(ggplot2)
library(plotly)
library(bslib)
library(forecast)
library(cluster)
library(factoextra)
library(readr)
library(GGally)
library(dplyr)
library(htmltools)

# Load the data
Data_Sheet1 <- read_csv("data/Data - Sheet1.csv", col_types = cols(`Facebook users per year` = col_number()))

# Define UI
ui <- fluidPage(
  theme = bs_theme(),
  titlePanel("Comprehensive Dashboard for Analyzing Trends in the Tech Industry"),
  h5("This dynamic dashboard, built using the Shiny framework in R, offers an immersive exploration of trends 
      within the tech sector. It encompasses a diverse array of variables such as phone sales, 
      internet usage, Facebook engagement, Amazon's sales figures, and the financial performance 
of industry giants like Meta Platforms and Google. Organized into intuitive tabs, each section provides unique
insights into different facets of the industry's evolution."),
  sidebarLayout(
    sidebarPanel(
      selectInput("xvar", "Choose a variable for x axis:",
                  choices = c("Year", "Number of Phones Sold", "Number of Internet Users", "Facebook Users per Year", "Amazon Annual Sales",
                              "Annual Revenue Generated by Meta Platforms", "Net Income Generated by Meta Platforms", "Annual Revenue of Google",
                              "Advertising Revenue of Google Network Websites")),
      hr(),
      helpText("Select a variable to plot against others."),
      checkboxGroupInput("yvars", "Choose variables for the y-axis:",
                         choices = c("Number of Phones Sold", "Number of Internet Users", "Facebook Users per Year", "Amazon Annual Sales",
                                     "Annual Revenue Generated by Meta Platforms", "Net Income Generated by Meta Platforms", "Annual Revenue of Google",
                                     "Advertising Revenue of Google Network Websites"),
                         selected = "Number of Internet Users")
    ),
    mainPanel(
      tabsetPanel(
        tabPanel("Internet Accessibility", 
                 plotOutput("internet_accessibility"),
                 textOutput("interpretation_internet_accessibility")),
        tabPanel("Correlation Analysis", 
                 plotOutput("correlation_plot"),
                 textOutput("interpretation_correlation_analysis")),
        tabPanel("Revenue and Net Income", 
                 plotOutput("revenue_net_income"),
                 textOutput("interpretation_revenue_net_income")),
        tabPanel("Amazon Annual Sales", 
                 plotOutput("amazon_sales"),
                 textOutput("interpretation_amazon_sales")),
        tabPanel("Advertising Revenue", 
                 plotOutput("advertising_revenue"),
                 textOutput("interpretation_advertising_revenue")),
        tabPanel("Internet Users vs. Facebook Users", 
                 plotOutput("internet_users_facebook"),
                 textOutput("interpretation_internet_users_facebook")),
        tabPanel("Custom Plot", 
                 plotlyOutput("plot"),
                 textOutput("interpretation_custom_plot")),
        tabPanel("Regression Analysis", 
                 plotOutput("regression_plot"),
                 textOutput("interpretation_regression_analysis")),
        tabPanel("Forecasting", 
                 plotOutput("forecasting_plot"),
                 textOutput("interpretation_forecasting")),
        tabPanel("Conclusion", 
                 textOutput("Conclusion")),
        tabPanel("Works Cited", 
                 textOutput("Work_Cited"))
      )
    )
  )
)

# Define server logic
server <- function(input, output) {
  # Internet Accessibility
  output$internet_accessibility <- renderPlot({
    ggplot(Data_Sheet1, aes(x = Year)) +
      geom_line(aes(y = `Number of internet users`, color = "Internet Users")) +
      geom_line(aes(y = `Number of Phones sold`, color = "Phones Sold")) + 
      labs(y = "Count", title = "Internet Accessibility") +
      theme_minimal() +
      theme(legend.position = "bottom")
  })
  
  output$interpretation_internet_accessibility <- renderText({
    "Between 2008 and 2016, the number of phones sold increased alongside the number of internet users. However, 
    from 2016 to 2023, phone sales declined while the number of internet users continued to rise. Several factors could explain
    this trend. Consumers may be using laptops more frequently, or they may be holding onto their phones longer, reducing the need
    for frequent replacements. Additionally, more age groups are accessing the internet, including those using older phones, 
    as internet usage has become widespread since its introduction in the late 1990s. The relationship between phone sales and 
    internet usage is evident, but it's evolving. Promoting phone sales can still contribute to increasing internet users, 
particularly by targeting segments that may benefit from upgraded devices, such as older adults or regions with 
lower smartphone penetration. However, the focus might also shift towards enhancing internet accessibility and usability 
across various devices, not just new phones."
  })
  
  # Correlation Analysis
  output$correlation_plot <- renderPlot({
    cor_matrix <- cor(Data_Sheet1[,-1], use = "complete.obs")
    corrplot::corrplot(cor_matrix, method = "color", col = c("white", "grey", "black"), 
                       title = "Correlation Matrix", mar=c(0,0,1,0))
  })
  
  output$interpretation_correlation_analysis <- renderText({
    "The correlation matrix provides insights into the relationships between 
    different variables. For example, if there is a high positive correlation between 
    the number of internet users and the number of phones sold, it indicates that 
    these two variables tend to increase together. However, the matrix also shows 
    relationships between other variables, which helps in understanding the 
    complex interactions within the data. This confirms that while there is a 
    relationship, we cannot rely solely on one variable to deduce changes in another. 
    It indicates that other factors also contribute significantly to the trends observed."
  })
  
  # Revenue and Net Income
  output$revenue_net_income <- renderPlot({
    ggplot(Data_Sheet1, aes(x = Year)) +
      geom_col(aes(y = `Annual revenue generated by Meta Platforms`, fill = "Meta Revenue")) +
      geom_col(aes(y = `Net Income generated by Meta Platforms`, fill = "Meta Net Income")) +
      geom_col(aes(y = `Annual revenue of google`, fill = "Google Revenue")) +
      labs(y = "Revenue/Net Income (in billions)", title = "Revenue and Net Income Growth of Meta Platforms and Google") +
      theme_dark() +
      theme(legend.position = "bottom")
  })
  
  output$interpretation_revenue_net_income <- renderText({
    "An increase in revenue generally leads to an increase in net income, since
net income is calculated as revenue minus expenses. However, it appears that
Google's revenue is insufficient when considering the overall financial
    performance. Given that many Meta Platforms rely heavily on Google for 
    advertising, this might not be a sustainable strategy in the long term.
    It could be more prudent for Meta Platforms to diversify their advertising
    strategies to ensure a more robust and resilient financial performance."
  })
  
  # Amazon Annual Sales
  output$amazon_sales <- renderPlot({
    ggplot(Data_Sheet1, aes(x = Year, y = `Amazon annual sales`)) +
      geom_line(color = "red") +
      labs(y = "Amazon Annual Sales (in billions)", title = "Amazon Annual Sales Growth") +
      theme_minimal() +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  })
  
  output$interpretation_amazon_sales <- renderText({
    "This time series illustrates Amazon's annual sales over the years, showing 
a consistent increase. Therefore, placing your products on Amazon could 
significantly enhance their reach and visibility in society."
  })
  
  # Advertising Revenue
  output$advertising_revenue <- renderPlot({
    ggplot(Data_Sheet1, aes(x = Year)) +
      geom_bar(aes(y = `Advertising revenue of Google network websites`, fill = "Google Advertising Revenue"), stat = "identity") +
      geom_bar(aes(y = `Annual revenue generated by Meta Platforms`, fill = "Meta Revenue"),stat = "identity") +
      labs(y = "Revenue (in billions)", title = "Advertising Revenue: Google vs. Meta") +
      theme_dark()+
      theme(legend.position = "right")
  })
  
  output$interpretation_advertising_revenue <- renderText({
    "According to the graph, Google's advertising revenue appears relatively 
    insignificant. It is more advantageous to use other Meta platforms for 
    advertising due to Google's limited current usage. The prevalent habit of 
constant phone scrolling presents an optimal opportunity for advertising on 
these platforms."
  })
  
  # Internet Users vs. Facebook Users
  output$internet_users_facebook <- renderPlot({
    ggplot(Data_Sheet1, aes(x = `Number of internet users`, y = `Facebook users per year`)) +
      geom_point() +
      geom_smooth(method = "lm", se = FALSE) +
      labs(x = "Number of Internet Users", y = "Facebook Users", title = "Internet Users vs. Facebook Users") +
      theme_minimal() +
      theme(panel.grid.major = element_line(size = 0.5))
  })
  
  output$interpretation_internet_users_facebook <- renderText({
    "The simple linear regression model indicates that as the number of internet
    users increases, the number of Facebook users also rises. However, Facebook 
    user growth seems to be reaching a steady state. This suggests that the 
    number of internet users no longer significantly impacts the number of 
    Facebook users. Factors contributing to this trend may include older people
    ceasing to use the platform and the presence of other popular platforms such
    as Instagram and TikTok. While Facebook remains a valuable platform for 
    advertising, it should not be the sole focus, given the competitive 
    landscape of social media."
  })
  
  # Custom Plot
  
  output$plot <- renderPlotly({
    # Convert input variables to corresponding column names
    xvar <- switch(input$xvar,
                   "Year" = "Year",
                   "Number of Phones Sold" = "Number of Phones sold",
                   "Number of Internet Users" = "Number of internet users",
                   "Facebook Users per Year" = "Facebook users per year",
                   "Amazon Annual Sales" = "Amazon annual sales",
                   "Annual Revenue Generated by Meta Platforms" = "Annual revenue generated by Meta Platforms",
                   "Net Income Generated by Meta Platforms" = "Net Income generated by Meta Platforms",
                   "Annual Revenue of Google" = "Annual revenue of google",
                   "Advertising Revenue of Google Network Websites" = "Advertising revenue of Google network websites")
    
    yvars <- lapply(input$yvars, function(var) {
      switch(var,
             "Number of Phones Sold" = "Number of Phones sold",
             "Number of Internet Users" = "Number of internet users",
             "Facebook Users per Year" = "Facebook users per year",
             "Amazon Annual Sales" = "Amazon annual sales",
             "Annual Revenue Generated by Meta Platforms" = "Annual revenue generated by Meta Platforms",
             "Net Income Generated by Meta Platforms" = "Net Income generated by Meta Platforms",
             "Annual Revenue of Google" = "Annual revenue of google",
             "Advertising Revenue of Google Network Websites" = "Advertising revenue of Google network websites")
    })
    
    plot_list <- lapply(yvars, function(yvar) {
      ggplot(Data_Sheet1, aes(x =!!sym(xvar), y =!!sym(yvar))) +
        geom_line() +
        geom_smooth(method = "lm", formula = y ~ x) +
        labs(x = input$xvar, y = yvar, title = paste(input$xvar, "vs", yvar)) +
        theme_dark()
    })
    
    # Combine plots into a single plotly object
    plotly_list <- lapply(plot_list, ggplotly)
    
    subplot(plotly_list, nrows = length(plotly_list), shareX = TRUE, titleX = TRUE)
  })
  
  output$interpretation_custom_plot <- renderText({
    "Feel free to use the sidebar to plot graphs and make comparisons as desired."
  })
  
  # Regression Analysis
  output$regression_plot <- renderPlot({
    ggplot(Data_Sheet1, aes(x = `Number of Phones sold`, y = `Number of internet users`)) +
      geom_point() +
      geom_smooth(method = "lm", se = FALSE) +
      labs(x = "Number of Phones Sold", y = "Number of Internet Users", title = "Regression Analysis") +
      theme_minimal()
  })
  
  output$interpretation_regression_analysis <- renderText({
    "Before proceeding to the forecasting tab to evaluate future revenue trends,
    I'll conduct a thorough regression analysis on the annual revenue of Meta 
    Platforms. This analysis will involve carefully handling outliers and 
    ensuring that each data point aligns appropriately with the regression line.
    By meticulously examining the relationship between the variables and the 
    model's performance, I aim to instill confidence in the accuracy of the
    forthcoming forecast. Leveraging the available information and robust 
    statistical techniques, I am confident that the forecast will provide 
    valuable insights into the future trajectory of Meta Platforms' revenue,
    thereby aiding informed decision-making and strategic planning within the 
    organization.The linear regression plot provides insights into the 
    relationship between the number of phones sold and the number of internet
    users. The linear model suggests a positive correlation between these two 
    variables, indicating that an increase in phone sales 
    is associated with an increase in internet usage."
  })
  
  output$forecasting_plot <- renderPlot({
    ts_data <- ts(Data_Sheet1$`Annual revenue generated by Meta Platforms`, start = min(Data_Sheet1$Year), frequency = 1)
    fit <- auto.arima(ts_data)
    forecast_data <- forecast(fit, h = 5)  # Forecast for next 5 years
    plot(forecast_data)
  })
  
  output$interpretation_forecasting <- renderText({
    "The forecasting plot demonstrates projected Amazon annual sales over the next five years. Utilizing this model, 
businesses can make informed decisions regarding inventory, marketing strategies, and other business activities 
to align with expected market trends."
  })
  
  output$Conclusion <- renderText({
    HTML("
        
    
    Inconclusion, The number of phones sold and internet users increased 
    together from 2008 to 2016. However, from 2016 to 2023, phone sales declined
    while internet users continued to rise. Promoting phone sales can still
    contribute to increasing internet users, particularly by targeting segments
    that may benefit from upgraded devices. The correlation matrix reveals 
    relationships between internet users and phones sold. While there is a 
    relationship, other factors also contribute significantly to the rise in 
    internet users, indicating a multifaceted influence on internet usage. An 
    increase in revenue generally leads to an increase in net income. However, 
    Google's revenue appears insufficient when considering overall financial 
    performance. It may be more prudent for Meta Platforms to diversify their 
    advertising strategies to ensure a more robust and resilient financial 
    performance.Amazon's annual sales have consistently increased over the years
    .Amazon remains a significant platform for product visibility and can 
    enhance the reach and impact of your products.Google's advertising revenue
    appears relatively insignificant compared to Meta Platforms. Meta Platforms
    are a more advantageous choice for advertising due to their higher 
    engagement and effectiveness.The relationship between internet users and
    Facebook users is explored, highlighting a positive correlation. Facebook 
    can tap into the growing internet user base to expand its reach and
    engagement further.Custom Plot: Users can create custom plots to compare
    variables and make desired comparisons. This feature allows for personalized
    analysis and deeper insights into specific areas of interest.A thorough
    regression analysis is conducted on the annual revenue of Meta Platforms. 
    This ensures accurate forecasting and provides a reliable basis for 
    financial predictions and strategic planning.The forecasted revenue for Meta
    Platforms indicates steady growth over the next few years. This suggests a 
    positive trajectory for the company's financial performance, highlighting 
    potential opportunities for expansion and investment.This comprehensive 
    dashboard provides a detailed analysis of trends in the tech industry, 
    offering valuable insights into the relationships between various variables 
    and the financial performance of industry giants. The forecasting component
    provides a positive outlook for Meta Platforms,highlighting potential 
    opportunities for expansion and investment. By leveraging these insights, 
    stakeholders can make informed decisions and strategically position 
    themselves in the evolving tech landscape.
  ")
  })
  
  output$Work_Cited <- renderText({
    "

1. Advertising Revenue of Google Network Sites 2018 | Statista. (2018). Statista.
Retrieved from https://www.statista.com/statistics/266245/advertising-revenue-of-google-network-sites/

2. Bianchi, T. (2024). Google: Revenue 2017 | Statista. Statista.
Retrieved from https://www.statista.com/statistics/266206/googles-annual-global-revenue/

3. Laricchia, F. (2024). Cell Phone Sales Worldwide 2007-2017 | Statista. Statista.
Retrieved from https://www.statista.com/statistics/263437/global-smartphone-sales-to-end-users-since-2007/

4. Statista. (2023). Facebook - Revenue and Net Income 2018 | Statista.
Retrieved from https://www.statista.com/statistics/277229/facebooks-annual-revenue-and-net-income/

5. Statista. (2024). Number of Monthly Active Facebook Users Worldwide as of 3rd Quarter 2023.
Retrieved from https://www.statista.com/statistics/264810/number-of-monthly-active-facebook-users-worldwide/

6. Statista. (2024). Annual Net Sales Revenue of Amazon from 2004 to 2023.
Retrieved from https://www.statista.com/statistics/

"
  })
}

# Run the application 
shinyApp(ui = ui, server = server)


